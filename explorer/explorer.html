<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Explorer - Paana</title>
  <meta name="description" content="Paana - Base de connaissances sur la sant√© publique en Polyn√©sie fran√ßaise">
  <link rel="stylesheet" href="header-footer.css" />

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9f9; 
      margin: 0; 
      height: 100vh; 
      overflow: hidden; }
    .layout-3col {
      display: grid;
      grid-template-columns: 300px 1fr 400px;
      gap: 20px;
      height: 100vh;
      box-sizing: border-box;
      padding: 20px;
    }
    .left-col, .center-col, .right-col {
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      overflow-y: auto;
    }
    .left-col { background: #f0f0f0; }
    .filters { display: flex; flex-direction: column; gap: 10px; }
    .dropdown-checkbox div { display: none; background: #fff; border: 1px solid #ccc; padding: 10px; position: relative; max-height: 140px; overflow-y: auto; display: block; }
    .dropdown-checkbox button { padding: 8px; font-size: 1rem; font-family: Segoe UI; font-weight: bold; color: #fdfdf0; background-color: #007b7f; border-radius: 5px; border: none; }
    .timeline { display: flex; flex-direction: column; gap: 20px; }
    .year-block { background: #fff; border: 1px solid #ccc; padding: 10px; border-radius: 8px; }
    .year-block h3 { text-align: center; }
    .year-block li {
      background: #e0e0e0;
      margin: 5px 0;
      padding: 6px;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .year-block li:hover { background: #dce775; }
    .event-details { border: 2px solid #000; border-radius: 10px; padding: 20px; }
    .color-box {
      display:inline-block;
      width:10px;
      height:10px;
      border-radius:2px;
    }
 .filters button,
.filters input[type="text"] {
  font-family: 'Segoe UI', sans-serif;
  font-size: 1rem;
  padding: 8px 12px;
  border: none;
  border-radius: 6px;
  margin-top: 10px;
}

.filters button:not(.reset-btn) {
  background-color: #007b7f;
  color: #fdfdf0;
}

.filters button:not(.reset-btn):hover {
  background-color: #006c70;
}

.filters input[type="text"] {
  background-color: #007b7f;
  color: #fdfdf0;
}

.filters input[type="text"]::placeholder {
  color: #fdfdf0;
  opacity: 0.7;
}

.filters .reset-btn {
  background-color: #fff3b0;
  color: #00587a;
}

.dropdown-checkbox div {
  display: none;
  background: #fff;
  border: 1px solid #ccc;
  padding: 10px;
  position: relative; max-height: 140px; overflow-y: auto; display: block;
  max-height: 120px;
  overflow-y: auto;
  margin-top: 5px;
} </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>

  
  <body>

  <header>
    <div class="logo">
      <span class="brand">Paana</span>
      <div class="trait"></div>
    </div>
    <nav>
      <a href="a-propos.html">A PROPOS</a>
      <a href="explorer.html">EXPLORER</a>
      <a href="https://forms.gle/PR8ZHvSXxLNYETtx9" target="_blank">SOUMETTRE</a>
      <a href="mailto:frise.sante.pf@gmail.com" title="Contacter par mail">
        <i class="fas fa-envelope fa-lg"></i>
      </a>
      <a href="index.html" title="Accueil">
        <i class="fas fa-house"></i> 
      </a>
    </nav>
  </header>

 <body>
  <div class="layout-3col">
    <div class="left-col">
      <div class="filters">
        <h3 style="font-family: Segoe UI; font-weight: bold; color: #007b7f;">Trier par</h3>
        <div class="dropdown-checkbox">
          <button onclick="toggleDropdown('categoryDropdown')">Cat√©gories</button>
          <div id="categoryDropdown">
      
      
    </div>
        
      
      
    </div>
        <div class="dropdown-checkbox">
          <button onclick="toggleDropdown('subjectDropdown')">Sujets</button>
          <div id="subjectDropdown">
      
      
    </div>
        
      
      
    </div>
        <div class="dropdown-checkbox">
          <button onclick="toggleDropdown('keywordDropdown')">Mots-cl√©s</button>
          <div id="keywordDropdown">
      
      
    </div>
        
      
      
    </div>
        <input type="text" id="searchInput" placeholder="Recherche globale..." oninput="updateTimeline()">
        <button class="reset-btn" onclick="resetFilters()">R√©initialiser</button>
      
      
      
    </div>
    </div>

    <div class="center-col">
      <div class="timeline" id="timeline">
      
      
    </div>
    </div>

    <div class="right-col">
      
    <div class="event-details" id="eventDetails">
      <h2>D√©tails</h2>
      <p><strong>Titre :</strong> <span id="detail-title">S√©lectionnez un √©v√©nement</span></p>
      <p><strong>Ann√©e :</strong> <span id="detail-year"></span></p>
      <p><strong>Cat√©gorie :</strong> <span id="detail-category"></span></p>
      <p><strong>Sujet :</strong> <span id="detail-subject"></span></p>
      <p><strong>Mots-cl√©s :</strong> <span id="detail-keywords"></span></p>
      <p><strong>Description :</strong> <span id="detail-description"></span></p>
      
    <p><strong>Sources :</strong> <span id="detail-sources">N/A</span></p>
    <p><strong>Pi√®ces jointes :</strong> <span id="detail-files">N/A</span></p>
    <div style="margin-top: 10px;">
    
        <button onclick="navigateEvent(-1)">‚¨Ö √âv√©nement pr√©c√©dent</button>
        <button onclick="navigateEvent(1)">√âv√©nement suivant ‚û°</button>
      
      
      
    </div>
    
        
    </div>
  </div>

<script>
const events = {
  1789: [{name: "R√©volution fran√ßaise", category: "Gouvernance", subject: "soci√©t√©", keywords: ["droits", "r√©publique"], description: "Fin de la monarchie absolue"}],
  1914: [{name: "Premi√®re Guerre mondiale", category: "Protection", subject: "guerre", keywords: ["arm√©e", "conflit"], description: "D√©but de la grande guerre"}],
  1918: [{name: "Grippe espagnole", category: "Protection", subject: "sant√©", keywords: ["pand√©mie"], description: "Grande pand√©mie mondiale"}],
  1945: [{name: "Fin de la Seconde Guerre mondiale", category: "Protection", subject: "guerre", keywords: ["victoire"], description: "Victoire des Alli√©s"}],
  1948: [{name: "D√©claration des droits", category: "Gouvernance", subject: "soci√©t√©", keywords: ["ONU", "droits"], description: "Texte fondateur des droits humains"}],
  1969: [{name: "Homme sur la Lune", category: "Donn√©es", subject: "science", keywords: ["NASA", "Lune"], description: "Mission Apollo 11"}],
  2001: [{name: "Attentats 11 septembre", category: "Protection", subject: "s√©curit√©", keywords: ["terrorisme"], description: "Attaques terroristes aux USA"}],
  2020: [{name: "COVID-19", category: "Protection", subject: "sant√©", keywords: ["virus", "pand√©mie"], description: "Pand√©mie mondiale"}]
};

const icons = {
  "Gouvernance": "üèõÔ∏è",
  "Donn√©es": "üìä",
  "Pr√©vention": "ü©∫",
  "Protection": "üõ°Ô∏è",
  "Acc√®s": "üö™",
  "Innovation": "üí°"
};

const colors = {
  "Gouvernance": "#7FB069",
  "Donn√©es": "#61A5C2",
  "Pr√©vention": "#F4A259",
  "Protection": "#DB5461",
  "Acc√®s": "#8D6CAB",
  "Innovation": "#3AAFA9"
};

function toggleDropdown(id) {
  const el = document.getElementById(id);
  el.style.display = el.style.display === "block" ? "none" : "block";
}

function resetFilters() {
  document.querySelectorAll("input[type=checkbox]").forEach(cb => cb.checked = false);
  document.getElementById("searchInput").value = "";
  updateTimeline();
}

function getFilters() {
  const getChecked = cls => Array.from(document.querySelectorAll("." + cls + "-filter:checked")).map(e => e.value);
  return {
    categories: getChecked("category"),
    subjects: getChecked("subject"),
    keywords: getChecked("keyword"),
    search: document.getElementById("searchInput").value.toLowerCase()
  };
}

function updateTimeline() {
  const container = document.getElementById("timeline");
  const filters = getFilters();
  container.innerHTML = "";

  for (const year in events) {
    const filtered = events[year].filter(e =>
      (!filters.categories.length || filters.categories.includes(e.category)) &&
      (!filters.subjects.length || filters.subjects.includes(e.subject)) &&
      (!filters.keywords.length || filters.keywords.some(k => e.keywords.includes(k))) &&
      (!filters.search || (
        e.name.toLowerCase().includes(filters.search) ||
        e.category.toLowerCase().includes(filters.search) ||
        e.subject.toLowerCase().includes(filters.search) ||
        e.keywords.some(k => k.toLowerCase().includes(filters.search))
      ))
    );

    if (filtered.length) {
      const block = document.createElement("div");
      block.className = "year-block";
      block.innerHTML = "<h3>" + year + "</h3><ul>" + 
        filtered.map(ev => {
          const icon = icons[ev.category] || "‚ùì";
          const color = colors[ev.category] || "#ccc";
          return `<li onclick='showDetails(${JSON.stringify(ev)}, ${year})'>
                    <span class="color-box" style="background:${color}"></span> ${icon} ${ev.name}
                  </li>`;
        }).join("") + "</ul>";
      container.appendChild(block);
    }
  }
}

function showDetails(ev, year) {
  document.getElementById("detail-title").innerText = ev.name;
  document.getElementById("detail-year").innerText = year;
  document.getElementById("detail-category").innerText = ev.category;
  document.getElementById("detail-description").innerText = ev.description;

  document.getElementById("detail-sources").innerText = ev.sources ? ev.sources.join(", ") : "N/A";
  document.getElementById("detail-files").innerText = ev.files ? ev.files.join(", ") : "N/A";

}

function initDropdowns() {
  const subjects = new Set();
  const keywords = new Set();
  const categories = new Set();

  Object.values(events).flat().forEach(e => {
    subjects.add(e.subject);
    e.keywords.forEach(k => keywords.add(k));
    categories.add(e.category);
  });

  document.getElementById("subjectDropdown").innerHTML =
    Array.from(subjects).sort().map(s => `<label><input type="checkbox" class="subject-filter" value="${s}" onchange="updateTimeline()"> ${s}</label><br>`).join("");

  document.getElementById("keywordDropdown").innerHTML =
    Array.from(keywords).sort().map(k => `<label><input type="checkbox" class="keyword-filter" value="${k}" onchange="updateTimeline()"> ${k}</label><br>`).join("");

  document.getElementById("categoryDropdown").innerHTML =
    Array.from(categories).sort().map(c => `<label><input type="checkbox" class="category-filter" value="${c}" onchange="updateTimeline()"> ${c}</label><br>`).join("");
}

initDropdowns();
updateTimeline();

let currentEvents = [];
let currentIndex = -1;

function showDetails(ev, year) {
  currentEvents = collectFilteredEvents();
  currentIndex = currentEvents.findIndex(e => e.name === ev.name);
  updateDetails(ev, year);
}

function updateDetails(ev, year) {
  document.getElementById("detail-title").innerText = ev.name;
  document.getElementById("detail-year").innerText = year;
  document.getElementById("detail-category").innerText = ev.category;
  document.getElementById("detail-subject").innerText = ev.subject;
  document.getElementById("detail-keywords").innerText = ev.keywords.join(", ");
  document.getElementById("detail-description").innerText = ev.description;

  document.getElementById("detail-sources").innerText = ev.sources ? ev.sources.join(", ") : "N/A";
  document.getElementById("detail-files").innerText = ev.files ? ev.files.join(", ") : "N/A";

}

function navigateEvent(direction) {
  if (currentEvents.length === 0 || currentIndex === -1) return;
  currentIndex = (currentIndex + direction + currentEvents.length) % currentEvents.length;
  const next = currentEvents[currentIndex];
  updateDetails(next, Object.keys(events).find(year => events[year].some(e => e.name === next.name)));
}

function collectFilteredEvents() {
  const filters = getFilters();
  return Object.entries(events).flatMap(([year, list]) =>
    list.filter(e =>
      (!filters.categories.length || filters.categories.includes(e.category)) &&
      (!filters.subjects.length || filters.subjects.includes(e.subject)) &&
      (!filters.keywords.length || filters.keywords.some(k => e.keywords.includes(k))) &&
      (!filters.search || (
        e.name.toLowerCase().includes(filters.search) ||
        e.category.toLowerCase().includes(filters.search) ||
        e.subject.toLowerCase().includes(filters.search) ||
        e.keywords.some(k => k.toLowerCase().includes(filters.search))
      ))
    )
  );
}

</script>
</body>
</html>
